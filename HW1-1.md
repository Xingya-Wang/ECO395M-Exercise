summary(ABIA)

#First remove the NA row in the data

ABIA<-subset(ABIA,ArrDelay!="NA")
ABIA<-subset(ABIA,DepDelay!="NA")

#Find a possible day of week and day of year that has the least delay

ABIA_summ=ABIA%>%
  group_by(Month,DayofMonth,DayOfWeek)%>%
  summarise(mean.ArrDelay=mean.default(ArrDelay),mean.DepDelay=mean.default(DepDelay))

ggplot(ABIA_summ) + 
  geom_point(mapping = aes(x = DayOfWeek, y = mean.DepDelay))
  
ggplot(ABIA_summ) + 
  geom_point(mapping = aes(x = DayOfWeek, y = mean.ArrDelay))
  
#From the plot we could see that Wednesday owns both the min Arrdelay and Depdelay

ggplot(ABIA_summ) + 
  geom_point(mapping = aes(x = DayofMonth, y =mean.DepDelay))+
  facet_wrap(~ Month, nrow = 2)
  
ggplot(ABIA_summ) + 
  geom_point(mapping = aes(x = DayofMonth, y =mean.ArrDelay))+
  facet_wrap(~ Month, nrow = 2)
  
#Combine these graphs, we could see that September has the least average delay in the month compare with other months.
#And may be we could consider that to fly during the Wednesdays of September may be that best choice to arrive on time.(Just a prediction)

ABIA_summ=ABIA%>%
  group_by(ArrTime,DepTime,Month,DayofMonth,DayOfWeek)%>%
  summarise(mean.DepDelay=mean.default(DepDelay),mean.ArrDelay=mean(ArrDelay))
  
ggplot(ABIA_summ) + 
  geom_point(mapping = aes(x = DepTime, y = mean.DepDelay))
  
ggplot(ABIA_summ) + 
  geom_point(mapping = aes(x = ArrTime, y = mean.ArrDelay))
  
#For different time of a day,it seems different between Depdelay and Arrdelay. However,it obeys the normal rule that we need some time during the route. Thus, we could read the figure that from 5 o'clock, the prob of delay tends to be higher.
